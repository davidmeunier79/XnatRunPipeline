
#* @vtlvariable name="data" type="org.apache.turbine.util.RunData" *#
#* @vtlvariable name="edit_screen" type="java.lang.String" *#
#* @vtlvariable name="item" type="org.nrg.xft.XFTItem" *#
#* @vtlvariable name="label" type="java.lang.String" *#
#* @vtlvariable name="link" type="org.apache.turbine.services.pull.tools.TemplateLink" *#
#* @vtlvariable name="om" type="org.nrg.xdat.om.TemplateSample" *#
#* @vtlvariable name="page" type="org.apache.turbine.util.template.HtmlPageAttributes" *#
#* @vtlvariable name="project" type="java.lang.String" *#
#* @vtlvariable name="subjectId" type="java.lang.String" *#
#* @vtlvariable name="turbineUtils" type="org.nrg.xdat.turbine.utils.TurbineUtils" *#
#* @vtlvariable name="ui" type="org.apache.turbine.services.pull.util.UIManager" *#
#* @vtlvariable name="vr" type="org.nrg.xft.utils.ValidationUtils.ValidationResults" *#
#* #addGlobalCustomScreens("header") *#

#* #addGlobalCustomScreens("topBar") *#

#* #addGlobalCustomScreens("header") *#


$page.setTitle("Run_Pipeline_Cluster")
$page.setLinkColor($ui.alink)
$page.setVlinkColor($ui.vlink)
#* set ($project = $om.getProject()) *#
#set ($project = $om.getProject())
#set ($PROJECT_DISPLAY_NAME = $displayManager.getSingularDisplayNameForProject().toLowerCase())
#set ($SUBJECT_DISPLAY_NAME = $displayManager.getSingularDisplayNameForSubject().toLowerCase())

#set( $placeholderId = "entry your id niolon" )
#set( $placeholderPwd = "entry your password" )


<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="js/jquery.tooltip/jquery.tooltip.js"></script>

<style>
	.loader{color:#fff;position:fixed;box-sizing:border-box;left:-9999px;top:-9999px;width:0;height:0;overflow:hidden;z-index:999999}.loader:after,.loader:before{box-sizing:border-box;display:none}.loader.is-active{background-color:rgba(0,0,0,.85);width:100%;height:100%;left:0;top:0}.loader.is-active:after,.loader.is-active:before{display:block}@keyframes rotation{0%{transform:rotate(0)}to{transform:rotate(359deg)}}@keyframes blink{0%{opacity:.5}to{opacity:1}}.loader[data-text]:before{position:fixed;left:0;top:50%;color:currentColor;font-family:Helvetica,Arial,sans-serif;text-align:center;width:100%;font-size:14px}.loader[data-text=""]:before{content:"Loading"}.loader[data-text]:not([data-text=""]):before{content:attr(data-text)}.loader[data-text][data-blink]:before{animation:blink 1s linear infinite alternate}.loader-default[data-text]:before{top:calc(50% - 63px)}.loader-default:after{content:"";position:fixed;width:48px;height:48px;border:8px solid #fff;border-left-color:transparent;border-radius:50%;top:calc(50% - 24px);left:calc(50% - 24px);animation:rotation 1s linear infinite}.loader-default[data-half]:after{border-right-color:transparent}.loader-default[data-inverse]:after{animation-direction:reverse}.loader-double:after,.loader-double:before{content:"";position:fixed;border-radius:50%;border:8px solid;animation:rotation 1s linear infinite}.loader-double:after{width:48px;height:48px;border-color:#fff;border-left-color:transparent;top:calc(50% - 24px);left:calc(50% - 24px)}.loader-double:before{width:64px;height:64px;border-color:#eb974e;border-right-color:transparent;animation-duration:2s;top:calc(50% - 32px);left:calc(50% - 32px)}.loader-bar[data-text]:before{top:calc(50% - 40px);color:#fff}.loader-bar:after{content:"";position:fixed;top:50%;left:50%;width:200px;height:20px;transform:translate(-50%,-50%);background:linear-gradient(-45deg,#4183d7 25%,#52b3d9 0,#52b3d9 50%,#4183d7 0,#4183d7 75%,#52b3d9 0,#52b3d9);background-size:20px 20px;box-shadow:inset 0 10px 0 hsla(0,0%,100%,.2),0 0 0 5px rgba(0,0,0,.2);animation:moveBar 1.5s linear infinite reverse}.loader-bar[data-rounded]:after{border-radius:15px}.loader-bar[data-inverse]:after{animation-direction:normal}@keyframes moveBar{0%{background-position:0 0}to{background-position:20px 20px}}.loader-bar-ping-pong:before{width:200px;background-color:#000}.loader-bar-ping-pong:after,.loader-bar-ping-pong:before{content:"";height:20px;position:absolute;top:calc(50% - 10px);left:calc(50% - 100px)}.loader-bar-ping-pong:after{width:50px;background-color:#f19;animation:moveBarPingPong .5s linear infinite alternate}.loader-bar-ping-pong[data-rounded]:before{border-radius:10px}.loader-bar-ping-pong[data-rounded]:after{border-radius:50%;width:20px;animation-name:moveBarPingPongRounded}@keyframes moveBarPingPong{0%{left:calc(50% - 100px)}to{left:calc(50% - -50px)}}@keyframes moveBarPingPongRounded{0%{left:calc(50% - 100px)}to{left:calc(50% - -80px)}}@keyframes corners{6%{width:60px;height:15px}25%{width:15px;height:15px;left:calc(100% - 15px);top:0}31%{height:60px}50%{height:15px;top:calc(100% - 15px);left:calc(100% - 15px)}56%{width:60px}75%{width:15px;left:0;top:calc(100% - 15px)}81%{height:60px}}.loader-border[data-text]:before{color:#fff}.loader-border:after{content:"";position:absolute;top:0;left:0;width:15px;height:15px;background-color:#ff0;animation:corners 3s ease both infinite}.loader-ball:before{content:"";position:absolute;width:50px;height:50px;top:50%;left:50%;margin:-25px 0 0 -25px;background-color:#fff;border-radius:50%;z-index:1;animation:kickBall 1s infinite alternate ease-in both}.loader-ball[data-shadow]:before{box-shadow:inset -5px -5px 10px 0 rgba(0,0,0,.5)}.loader-ball:after{content:"";position:absolute;background-color:rgba(0,0,0,.3);border-radius:50%;width:45px;height:20px;top:calc(50% + 10px);left:50%;margin:0 0 0 -22.5px;z-index:0;animation:shadow 1s infinite alternate ease-out both}@keyframes shadow{0%{background-color:transparent;transform:scale(0)}40%{background-color:transparent;transform:scale(0)}95%{background-color:rgba(0,0,0,.75);transform:scale(1)}to{background-color:rgba(0,0,0,.75);transform:scale(1)}}@keyframes kickBall{0%{transform:translateY(-80px) scaleX(.95)}90%{border-radius:50%}to{transform:translateY(0) scaleX(1);border-radius:50% 50% 20% 20%}}.loader-smartphone:after{content:"";color:#fff;font-size:12px;font-family:Helvetica,Arial,sans-serif;text-align:center;line-height:120px;position:fixed;left:50%;top:50%;width:70px;height:130px;margin:-65px 0 0 -35px;border:5px solid #fd0;border-radius:10px;box-shadow:inset 0 5px 0 0 #fd0;background:radial-gradient(circle at 50% 90%,rgba(0,0,0,.5) 6px,transparent 0),linear-gradient(0deg,#fd0 22px,transparent 0),linear-gradient(0deg,rgba(0,0,0,.5) 22px,rgba(0,0,0,.5));animation:shake 2s cubic-bezier(.36,.07,.19,.97) both infinite}.loader-smartphone[data-screen=""]:after{content:"Loading"}.loader-smartphone:not([data-screen=""]):after{content:attr(data-screen)}@keyframes shake{5%{transform:translate3d(-1px,0,0)}10%{transform:translate3d(1px,0,0)}15%{transform:translate3d(-1px,0,0)}20%{transform:translate3d(1px,0,0)}25%{transform:translate3d(-1px,0,0)}30%{transform:translate3d(1px,0,0)}35%{transform:translate3d(-1px,0,0)}40%{transform:translate3d(1px,0,0)}45%{transform:translate3d(-1px,0,0)}50%{transform:translate3d(1px,0,0)}55%{transform:translate3d(-1px,0,0)}}.loader-clock:before{width:120px;height:120px;border-radius:50%;margin:-60px 0 0 -60px;background:linear-gradient(180deg,transparent 50%,#f5f5f5 0),linear-gradient(90deg,transparent 55px,#2ecc71 0,#2ecc71 65px,transparent 0),linear-gradient(180deg,#f5f5f5 50%,#f5f5f5 0);box-shadow:inset 0 0 0 10px #f5f5f5,0 0 0 5px #555,0 0 0 10px #7b7b7b;animation:rotation infinite 2s linear}.loader-clock:after,.loader-clock:before{content:"";position:fixed;left:50%;top:50%;overflow:hidden}.loader-clock:after{width:60px;height:40px;margin:-20px 0 0 -15px;border-radius:20px 0 0 20px;background:radial-gradient(circle at 14px 20px,#25a25a 10px,transparent 0),radial-gradient(circle at 14px 20px,#1b7943 14px,transparent 0),linear-gradient(180deg,transparent 15px,#2ecc71 0,#2ecc71 25px,transparent 0);animation:rotation infinite 24s linear;transform-origin:15px center}.loader-curtain:after,.loader-curtain:before{position:fixed;width:100%;top:50%;margin-top:-35px;font-size:70px;text-align:center;font-family:Helvetica,Arial,sans-serif;overflow:hidden;line-height:1.2;content:"Loading"}.loader-curtain:before{color:#666}.loader-curtain:after{color:#fff;height:0;animation:curtain 1s linear infinite alternate both}.loader-curtain[data-curtain-text]:not([data-curtain-text=""]):after,.loader-curtain[data-curtain-text]:not([data-curtain-text=""]):before{content:attr(data-curtain-text)}.loader-curtain[data-brazilian]:before{color:#f1c40f}.loader-curtain[data-brazilian]:after{color:#2ecc71}.loader-curtain[data-colorful]:before{animation:maskColorful 2s linear infinite alternate both}.loader-curtain[data-colorful]:after{animation:curtain 1s linear infinite alternate both,maskColorful-front 2s 1s linear infinite alternate both;color:#000}@keyframes maskColorful{0%{color:#3498db}49.5%{color:#3498db}50.5%{color:#e74c3c}to{color:#e74c3c}}@keyframes maskColorful-front{0%{color:#2ecc71}49.5%{color:#2ecc71}50.5%{color:#f1c40f}to{color:#f1c40f}}@keyframes curtain{0%{height:0}to{height:84px}}.loader-music:after,.loader-music:before{content:"";position:fixed;width:240px;height:240px;top:50%;left:50%;margin:-120px 0 0 -120px;border-radius:50%;text-align:center;line-height:240px;color:#fff;font-size:40px;font-family:Helvetica,Arial,sans-serif;text-shadow:1px 1px 0 rgba(0,0,0,.5);letter-spacing:-1px}.loader-music:after{backface-visibility:hidden}.loader-music[data-hey-oh]:after,.loader-music[data-hey-oh]:before{box-shadow:0 0 0 10px}.loader-music[data-hey-oh]:before{background-color:#fff;color:#000;animation:coinBack 2.5s linear infinite,oh 5s 1.25s linear infinite both}.loader-music[data-hey-oh]:after{background-color:#000;animation:coin 2.5s linear infinite,hey 5s linear infinite both}.loader-music[data-no-cry]:after,.loader-music[data-no-cry]:before{background:linear-gradient(45deg,#009b3a 50%,#fed100 51%);box-shadow:0 0 0 10px #000}.loader-music[data-no-cry]:before{animation:coinBack 2.5s linear infinite,cry 5s 1.25s linear infinite both}.loader-music[data-no-cry]:after{animation:coin 2.5s linear infinite,no 5s linear infinite both}.loader-music[data-we-are]:before{animation:coinBack 2.5s linear infinite,theWorld 5s 1.25s linear infinite both;background:radial-gradient(ellipse at center,#4ecdc4 0,#556270)}.loader-music[data-we-are]:after{animation:coin 2.5s linear infinite,weAre 5s linear infinite both;background:radial-gradient(ellipse at center,#26d0ce 0,#1a2980)}.loader-music[data-rock-you]:before{animation:coinBack 2.5s linear infinite,rockYou 5s 1.25s linear infinite both;background:#444}.loader-music[data-rock-you]:after{animation:coin 2.5s linear infinite,weWill 5s linear infinite both;background:#96281b}@keyframes coin{to{transform:rotateY(359deg)}}@keyframes coinBack{0%{transform:rotateY(180deg)}50%{transform:rotateY(1turn)}to{transform:rotateY(180deg)}}@keyframes hey{0%{content:"Hey!"}50%{content:"Let's!"}to{content:"Hey!"}}@keyframes oh{0%{content:"Oh!"}50%{content:"Go!"}to{content:"Oh!"}}@keyframes no{0%{content:"No..."}50%{content:"no"}to{content:"No..."}}@keyframes cry{0%{content:"woman"}50%{content:"cry!"}to{content:"woman"}}@keyframes weAre{0%{content:"We are"}50%{content:"we are"}to{content:"We are"}}@keyframes theWorld{0%{content:"the world,"}50%{content:"the children!"}to{content:"the world,"}}@keyframes weWill{0%{content:"We will,"}50%{content:"rock you!"}to{content:"We will,"}}@keyframes rockYou{0%{content:"we will"}50%{content:"\1F918"}to{content:"we will"}}.loader-pokeball:before{content:"";position:absolute;width:100px;height:100px;top:50%;left:50%;margin:-50px 0 0 -50px;background:linear-gradient(180deg,red 42%,#000 0,#000 58%,#fff 0);background-repeat:no-repeat;background-color:#fff;border-radius:50%;z-index:1;animation:movePokeball 1s linear infinite both}.loader-pokeball:after{content:"";position:absolute;width:24px;height:24px;top:50%;left:50%;margin:-12px 0 0 -12px;background-color:#fff;border-radius:50%;z-index:2;animation:movePokeball 1s linear infinite both,flashPokeball .5s infinite alternate;border:2px solid #000;box-shadow:0 0 0 5px #fff,0 0 0 10px #000}@keyframes movePokeball{0%{transform:translateX(0) rotate(0)}15%{transform:translatex(-10px) rotate(-5deg)}30%{transform:translateX(10px) rotate(5deg)}45%{transform:translatex(0) rotate(0)}}@keyframes flashPokeball{0%{background-color:#fff}to{background-color:#fd0}}.loader-bouncing:after,.loader-bouncing:before{content:"";width:20px;height:20px;position:absolute;top:calc(50% - 10px);left:calc(50% - 10px);border-radius:50%;background-color:#fff;animation:kick .6s infinite alternate}.loader-bouncing:after{margin-left:-30px;animation:kick .6s infinite alternate}.loader-bouncing:before{animation-delay:.2s}@keyframes kick{0%{opacity:1;transform:translateY(0)}to{opacity:.3;transform:translateY(-1rem)}}
	#monselectPipeLine{width: 30%;padding: 10px;border-radius: 10px} .inputStep3{font-size: 14pt;width : 450px;}
:root {
  --modal-duration: 4s;
  --modal-color: #428bca;
}

.button {
  background: #428bca;
  padding: 1em 2em;
  color: #fff;
  border: 0;
  border-radius: 5px;
  cursor: pointer;
}

.btn1{

  background: #428bca;
  padding: 0.5em 2em;
  color: #fff;
  border: 0;
  font-size : 1.2em;
  border-radius: 5px;
  cursor: pointer;

}

.button:hover {
  background: #3876ac;
}

.modal {
  display: none;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  height: 100%;
  width: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.5);
}

.modal-content {
  margin: 10% auto;
  width: 60%;
  box-shadow: 0 5px 8px 0 rgba(0, 0, 0, 0.2), 0 7px 20px 0 rgba(0, 0, 0, 0.17);
  animation-name: modalopen;
  animation-duration: var(--modal-duration);
}

.modal-header h2,
.modal-footer h3 {
  margin: 0;
}

.modal-header {
  background: var(--modal-color);
  padding: 15px;
  color: #fff;
  border-top-left-radius: 5px;
  border-top-right-radius: 5px;
}

.modal-body {
  padding: 10px 20px;
  background: #fff;
}

.modal-footer {
  background: var(--modal-color);
  padding: 10px;
  color: black;
  text-align: center;
  border-bottom-left-radius: 5px;
  border-bottom-right-radius: 5px;
}

.close {
  color: #ccc;
  float: right;
  font-size: 30px;
  color: #fff;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
.options {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}

.btn {
  color:inherit;
    font-family:inherit;
  font-size: inherit;
  background: white;
  padding: 0.3rem 3.4rem;
  border: 3px solid black;
  margin-right: 2.6rem;
  box-shadow: 0 0 0 black;
  transition: all 0.2s;
}

.btn:last-child {
  margin: 0;
}

.btn:hover {
  box-shadow: 0.4rem 0.4rem 0 black;
  transform: translate(-0.4rem, -0.4rem);
}

.btn:active {
  box-shadow: 0 0 0 black;
  transform: translate(0, 0);
}

@keyframes modalopen {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}


#loader {
  display: none;
  position: absolute;
  left: 50%;
  top: 50%;
  width: 120px;
  height: 120px;
  z-index: 1;
  margin: -76px 0 0 -76px;
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #3498db;
  -webkit-animation: spin 2s linear infinite;
  animation: spin 2s linear infinite;
  background-color: rgba(0, 0, 0, 0.5);

}

@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@import url('//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css');

.bandeau-message {
  position: relative;
  padding: 20px;
  margin: 20px 0;
  margin-bottom: 1rem;
  border-radius: 3px 3px 3px 3px;
  border: 1px solid transparent;
    border-top-color: transparent;
    border-top-style: solid;
    border-top-width: 10px;
    border-right-color: transparent;
    border-right-style: solid;
    border-right-width: 10px;
    border-bottom-color: transparent;
    border-bottom-style: solid;
    border-bottom-width: 10px;
    border-left-color: transparent;
    border-left-style: solid;
    border-left-width: 10px;
    border-image-outset: 0;
    border-image-repeat: stretch;
    border-image-slice: 100%;
    border-image-source: none;
    border-image-width: 1;
}

.alert-success {
  color: #155724;
  padding: 20px;
  border-radius : 3px 3px 3px 3px;
  background-color: #d4edda;
  border-color: #c3e6cb;
    border-top-color: rgb(195, 230, 203);
    border-right-color: rgb(195, 230, 203);
    border-bottom-color: rgb(195, 230, 203);
    border-left-color: rgb(195, 230, 203);
}

.success-msg,
.error-msg,
.info-msg {
  margin: 11px 0;
  padding: 10px;
  border-radius: 5px 5px 5px 5px;
}

.error-msg {
  display:none;
  color: #D8000C;
  background-color: #FFBABA;
  width: 340px;
}

.success-msg {
  color: #270;
  background-color: #DFF2BF;
  font-size: 13pt;
  width : 450px;
  line-height : 20px;

}

.info-msg{


  margin-left : 20px;

   margin-right : 400px;
  color: #059;
  background-color: #BEF;
}




</style>
<img src="data:image/jpeg;base64,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ldHZley3z1Mxbq2y2OZtLQN1Lh9TOjVK7OEOYKFVFJsRdranc6bQPD8MWyoHZXFR6yMLZgzEk6EWI65FjyMD2mBqllL4hmCnNlVVQMRsGI1I8IG/B4YIatjcu5qHbTMALeXVgR24WjLVGZvrKgqgjRkdcoUrccjTB1geW4bVawqYhmS4JAVEJsQQCw1tpra0D3V4c+d6lKqaeexcZVZSQMoYA7GwA35QA4axSqr1qjM9usCFyW2yAaDx3vzgaMTwmrURqdTEEowswFOmCQdxfl5wLdRbSBmAgICAgICAgICAgICAgICAgICBhhoYFZSwjDovqwCpBZsw1sCCe83PfAxRwThluNQ1y111177ZjpygS8ZRZjdbdh1F+9stvlAj4PCsrg2sMpB7OpNraL5HeB7fDEVCwRTmydY8rbm3PSBilgiSucAgKw1N9S1/lAUcCVFOwGYNcm+uW50vz0tpA1rg20GQZswJqX1PWvfv20t4wNjYHqsbDPnLA31AzXGvLTlA01sE5Zza5LXDXUWGltSLi3hAtoCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB/9k=" alt="ICM Logo"/>

<h2>INT : RUN Pipeline for $PROJECT_DISPLAY_NAME [$project] </h2>

		<!-- action="$content.getURI("/xapi/icm-export-data/export-files/$project")" -->
	<div id="export-project-data-form" class="noHide"  >


			<div class="container">
				<div class="withColor containerTitle">Step 1 : ENTER YOUR  ID TO GET PIPELINES LIST EXISTS ON CLUSTER  </div>
					<br/>
					<div style="display:inline; display: none;" id="div-id-user">
						<div class="containerItem" >
							<label > <strong> ID user niolon : </strong> </label>
							<input type="text" id="idNiolon" name="iDniolon" placeholder="$placeholderId" required="true" >
							<!--    <label > Mot de passe </label>
							<input type="password" id="password" name="password" placeholder="$placeholderPwd" required="true"> -->
							<button class="btn1" id="btnGetPiplines" data='$content.getURI("/xapi/int-run-pipline/get-pipelines/$project")' > Get Pipelines List</button>
							<br/><br/>
							<div class="error-msg" id="div-error-msg">
								<i class="fa fa-times-circle"></i>
								This id is not valide.
							</div>
						</div>

				</div>

			<div style="display:inline; margin-left:20px; margin-top: -80px">
				<label class="access-label"> <strong>Pipelines exists on cluster : </strong></label>
				<select  id="monselectPipeLine" >
					<option value="">Please choose a pipeline</option>
				</select>
			</div>
			<br/><br/>


				<!--
					<div class="bandeau-message">
						<div class="alert-success" role="alert" tabindex="0">
							Etape terminee le 8 mai 2022 a 23:19:01
						</div>
					</div>
				-->

				<div class="info-msg"  id="div-info-msg" style="display:none;">
					  <i class="fa fa-info-circle" id="link-pipeline" > </i>


				</div>

			</div>
			<br>
			<!--"display: inline; margin: auto;width: 50%; padding: 10px;"-->


		<br/>
		<br/>

		<div class="container">
			<div class="withColor containerTitle">Step 2 : Select $SUBJECT_DISPLAY_NAME(s)</div>
			<div class="containerItem" style="display: inline-block;">

				<div id="subject-select-div" class="radio-toggle" style="display: inline-block;">
					<label class="access-label" title="All subjects in the project">
						<input type="radio" id="all_subjects" checked="checked" name="subject_choice" value="all"/>All
					</label>
					<label class="access-label" title="Select subject(s)">
						<input type="radio" id="some_subjects" name="subject_choice" value="some"/>Subject(s)
					</label>
					<!-- http://localhost:8080/xnat/REST/projects/PASSEPORT/subjects/ -->
							<select multiple size="6" id="subjects_list" name="subjects_list" disabled="disabled" style="width : 130px" >


							</select>

					<input type="hidden" id="subject_ids" name="subject_ids" value=""/>
					<br/> <br/>
				</div>
				<div  style="float:right; margin-left: 25px; ">
						<select multiple size="6" id="subsession_list" name="subsession_list" style="margin-right: 25px; width : 150px">

						</select>
				</div>

			</div>
		</div>
		<br/>
		<br/>

		<div class="container" >

		</div>





		<br/><br/><br/>
		<div class="container" id="div_step3" style="display:none;">
			<div class="withColor containerTitle">Step 3 : Enter the parameters : </div>
			<label class="access-label" title="All subjects in the project"> </label>

			<div class="containerItem">

			<div class="success-msg">
				<i class="fa fa-info-circle"></i>
				Set computation parameters
			</div>
				<h3 id="monColor"  >Choose the name of your team
					<span class="tip_icon" style="margin-right:3px;">
				 		<span class="tip shadowed" style="top:20px;z-index:10000;white-space:normal;left:0x;width:300px;background-color:#ffc;">
				 			Make sure you choose the right name for your team
				 		</span>
				 	</span>
				</h3>
				<div id="teamListenames">

				<label>
					<input type="checkbox" class="radio" value="crise" name="fooby[team][]" />crise</label>
				<label>
					<input type="checkbox" class="radio" value="banco" name="fooby[team][]" />banco</label>
				<label>
					<input type="checkbox" class="radio" value="meca" name="fooby[team][]" />meca</label>
				</div>

				<br/>



				<label > <h3> Name Export Dir ( E.G :  /hpc/team)
							<span class="tip_icon" style="margin-right:3px;">
				 				<span class="tip shadowed" style="top:20px;z-index:10000;white-space:normal;left:0x;width:300px;background-color:#ffc;">
				 					This field is not editable, it allows you to make sure that you have chosen the right working directory
								</span>
							</span>
						</h3>
				</label>
				<input class="inputStep3" type="text" id="nameExportDir" name="nameExportDir" disabled required>
				<br/><br/>
					<div style="display: inline;">
						<label> <strong> Delete raw data after BIDS conversion ? </strong></label>
						<label>
							<input type="radio" name="choice-radio" value="yes">
							Yes
						</label>

						<label>
							<input type="radio" name="choice-radio" value="no" checked>
							No
						</label>

						<span class="tip_icon" style="margin-right:10px;">
				 				<span class="tip shadowed" style="top:20px;z-index:10000;white-space:normal;left:0x;width:300px;background-color:#ffc;">
				 					If you want to <strong>delete </strong> the data once the conversion to BIDS has been done click on <strong>Yes</strong>
								</span>
						</span>

					</div>
				<!--
				<br/> <br/>
				<label > <h3> Name of Slurm Job (optional)
					<span class="tip_icon" style="margin-right:3px;">
				 		<span class="tip shadowed" style="top:20px;z-index:10000;white-space:normal;left:0x;width:300px;background-color:#ffc;">
				 			You can assign a name to your job to track it under this name on the cluster
				 		</span>
				 	</span>
				</h3>

				</label>
				<input class="inputStep3" type="text" id="nameSlurmJob" name="nameSlurmJob" >
				-->
				<br/><br/>


				<label > <h3> extra parameters command xnat2bids

							<span class="tip_icon" style="margin-right:3px;">
				 				<span class="tip shadowed" style="top:20px;z-index:10000;white-space:normal;left:0x;width:300px;background-color:#ffc;">
				 					Par defaut vide ! Pour toute autre option consultez la doc.
								</span>
							</span>

						 </h3></label>
				<input class="inputStep3" type="text" id="command_extra_bids" name="command_extra_bids" >
				<br/><br/>



				<div class="success-msg">
					<i class="fa fa-info-circle"></i>
					Set command parameters
				</div>



				<label > <h3> command start

							<span class="tip_icon" style="margin-right:3px;">
				 				<span class="tip shadowed" style="top:20px;z-index:10000;white-space:normal;left:0x;width:300px;background-color:#ffc;">
				 					If you have other parameters that you consider interesting for the Singularity command , add them here.  Separate by spaces !
								</span>
							</span>

						 </h3></label>
				<input class="inputStep3" type="text" id="commande_befor" name="commande_befor" >
				<br/><br/>
				<label > <h3> command parameters

							<span class="tip_icon" style="margin-right:3px;">
				 				<span class="tip shadowed" style="top:20px;z-index:10000;white-space:normal;left:0x;width:300px;background-color:#ffc;">
				 					If you have other parameters that you consider interesting for the Singularity command , add them here.  Separate by spaces !
								</span>
							</span>

						 </h3></label>
				<input class="inputStep3" type="text" id="commande_after" name="commande_after" >
				<br/><br/>
				<label > <h3> command participant parameters

							<span class="tip_icon" style="margin-right:3px;">
				 				<span class="tip shadowed" style="top:20px;z-index:10000;white-space:normal;left:0x;width:300px;background-color:#ffc;">
				 					participant or group !
								</span>
							</span>

						 </h3></label>
				<input class="inputStep3" type="text" id="commande_participant" name="commande_participant" >
				<br/><br/>



				<label > <h3> command extra parameters

							<span class="tip_icon" style="margin-right:3px;">
				 				<span class="tip shadowed" style="top:20px;z-index:10000;white-space:normal;left:0x;width:300px;background-color:#ffc;">
				 					If you have other parameters that you consider interesting for the Singularity command , add them here.  Separate by spaces !
								</span>
							</span>

						 </h3></label>
				<input class="inputStep3" type="text" id="additionalParams" name="additionalParams" >
				<br/><br/>
				<button class="btn1" id="btnStartPipline" data='$content.getURI("/xapi/int-run-pipline/start-pipeline/$project")' > start computation </button>

			</div>


			<br/><br/>
		</div>


		<div>


		</div>


	</div>

<!--<button id="modal-btn" class="button">Click Here</button> -->

  <div id="my-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">

        <h2 >These are the parameters you have chosen </h2>
      </div>
      <div class="modal-body">
	  	<h2 ></h2>
        <p id="pipelineSelected"></p>
        <p ></p>
		<p id="nameProject"></p>
		<p id="subjectsSelected"></p>
		<p id="sessionsSelected"></p>
		<p id="nameTeamSelected"></p>
		<br>
		<P id="workDirPath">  Press <strong> Continue </strong> if you are sure on your parameters or <strong>
			Modify </strong> to change </h3></p>
      </div>
      <div class="modal-footer">
			<div class="options">
              <button id="bntContinue" class="btn">  <strong> Continue </strong></button>
              <button id="bntModify" class="btn"> <strong> Modify  </strong></button>
           	</div>

      </div>
    </div>
  </div>

    <div id="my-modal-continue" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="close">&times;</span>
        <h2 >Information sur votre pipeline </h2>
      </div>
      <div class="modal-body">
	  	<h2 id="nameModale"></h2>
        <p id="idJob"></p>
		<br><br>
		<P id="workindDirectory"></p>
		<br><br>
        <p id="pathWithnNameScriptSbatch"></p>
		<br><br>
        <p id="pathErrorLogOut"></p>
		<br><br>
        <p id="pathErrorLogErr"></p>
      </div>
      <div class="modal-footer">
        <h3 style="text-color:white;">Votre job est encours d'execution</h3>
			<div class="options">
			  <button id="btnSave" class="btn"> <strong> Save  </strong></button>
              <button id="btnOkFinale" class="btn">  <strong> Ok </strong></button>
           	</div>
      </div>
    </div>
  </div>

  <div id="loader"></div>









<script>



/*
 $(function() {
    $( document ).tooltip();
  });
  */




let nameSelectedTeam = "";
let namfileTogenerateByBrowser = "";





// Shorthand for $( document ).ready()
$(function() {

			// on check si l'ID xnat est le même sur niolon , si oui on affiche la suite si non on propose de saisir son id niolon
			$.ajax({
				url: "/xapi/int-run-pipline/check-user-id",
				method:'POST',
				success: function(data) {
					if(data.pipelines !="null"){

						console.log("Vous avez  reçu" + data.toString())
					// To sort data


						$("#idNiolon").val(data.id);


						getTeams()

						$("#idNiolon").prop("disabled",true);
						const sortObject = obj => Object.keys(obj).sort().reduce((res, key) => (res[key] = obj[key], res), {});
						data = sortObject(data.pipelines);
						$("#div-error-msg").hide();
						$("#div_step3").show();
						var $select = $("#monselectPipeLine");                           // Locate HTML DOM element with ID "someselect".
						$select.find("option").remove();                          // Find all child elements with tag name "option" and remove them (just to prevent duplicate options when button is pressed again).
						$.each(data, function(key, value) {               // Iterate over the JSON object.
							$("<option>").val(key).text(value).appendTo($select); // Create HTML <option> element, set its value with currently iterated key and its text content with currently iterated item and finally append it to the <select>.

						});

						const pipeline = $('#monselectPipeLine option:selected').text()
						getInfAboutPipelineSelected(pipeline); // reccupérer le lien de la doc du pipeline selectionné

						$('#div-info-msg').show();

					}

					else {

						//console.log("aucune donnée reçu" + data);
						$("#div-id-user").show();
						$("#div_step3").hide();
						$("#div-info-msg").hide();
						$("#div-error-msg").show();

						// Supprimer toutes les options si déja la liste était initialisée
						$('#monselectPipeLine')
							.empty()
							.append('<option selected="selected" value="">Please choose a pipeline</option>');


					}



				}
			});


});






$(function() {

	$('#btnGetPiplines').on("click" , function(e) {



		getTeams()

		//get url
		let _urlGetPiplines = document.getElementById("btnGetPiplines").getAttribute("data");
			//alert(_urlGetPiplines);

			let idCluster = $('#idNiolon').val();
			let btnStartPipline = $('#btnStartPipline').disabled;

			//let subject_ids = $('#subject_ids').val();
			//let subject_ids = "XNAT_INT_S00031";
			let subject_ids = $('#subjects_list').val();
			subject_ids = subject_ids.toString();
				if (subject_ids == "" && $('#all_subjects').attr("checked", "checked")){

				subject_ids = "all";
				}
			console.log("  tu as choisis les sujets : "+subject_ids);

			let selectOptionsPipeline = "";


			$.ajax({
				url: _urlGetPiplines,
				data: {"idCluster":idCluster , "subject_ids":subject_ids},
				method:'POST',
				success: function(data) {
					if(data.pipelines !="null"){

						console.log("Vous avez  reçu" + data.toString())
					// To sort data


						$("#idNiolon").prop("disabled",true);
						const sortObject = obj => Object.keys(obj).sort().reduce((res, key) => (res[key] = obj[key], res), {});
						data = sortObject(data.pipelines);
						$("#div-error-msg").hide();
						$("#div_step3").show();
						var $select = $("#monselectPipeLine");                           // Locate HTML DOM element with ID "someselect".
						$select.find("option").remove();                          // Find all child elements with tag name "option" and remove them (just to prevent duplicate options when button is pressed again).
						$.each(data, function(key, value) {               // Iterate over the JSON object.
							$("<option>").val(key).text(value).appendTo($select); // Create HTML <option> element, set its value with currently iterated key and its text content with currently iterated item and finally append it to the <select>.

						});

						const pipeline = $('#monselectPipeLine option:selected').text()
						getInfAboutPipelineSelected(pipeline); // reccupérer le lien de la doc du pipeline selectionné

						$('#div-info-msg').show();

					}

					else {

						//console.log("aucune donnée reçu" + data);
						$("#div_step3").hide();
						$("#div-info-msg").hide();
						$("#div-error-msg").show();

						// Supprimer toutes les options si déja la liste était initialisée
						$('#monselectPipeLine')
							.empty()
							.append('<option selected="selected" value="">Please choose a pipeline</option>');


					}



					// Activer le bouton start computation
					//$('#btnStartPipline').disabled =true;
					//alert("Tres bien envoyer")


				}
			});
	})


});

/* Cette fonction permet d'initialiser les params par défaut pour tous les pipelines */

$(function (){

	$('#monselectPipeLine').on('change', function() {




		//$('#nameExportDir').val("/hpc/" +nameSelectedTeam);

		let pipeline  = $(this).find(":selected").text();

		getInfAboutPipelineSelected(pipeline);

		//$('#nameSlurmJob').val(pipeline);


	});

});

// Cette fonction permet de récupérer les sessions qui corréspond à  un ou plusieur sujet(s)
$(function (){

	let _url = "/xapi/int-run-pipline/get-sessions/$project";
	let selectedSubject = "";

	$('#subjects_list').change(function() {

	let sessions_ids = $('#subsession_list').val();
	sessions_ids = sessions_ids.toString();
	console.log(sessions_ids)



	//selectedSubject = $('option:selected', $(this)).text();

	// retourne la liste des sujets  selectionnés
	selectedSubject = $('option:selected', $(this)).map(function(){ return this.text }).get().join(",");

	console.log(selectedSubject)

	console.log(_url);


		$.ajax({
			url: _url,
			method:'POST',
			data: {"selectedSubject":selectedSubject},
			success: function(data) {

				if(data != null){


					// To sort data
					const sortObject = obj => Object.keys(obj).sort().reduce((res, key) => (res[key] = obj[key], res), {});

					data = sortObject(data);
					//data = data.sort()
					console.log(data)
					var $select = $("#subsession_list");                           // Locate HTML DOM element with ID "someselect".
					$select.find("option").remove();                          // Find all child elements with tag name "option" and remove them (just to prevent duplicate options when button is pressed again).
					$.each(data, function(key, value) {               // Iterate over the JSON object.
						$("<option selected>").val(key).text(value).appendTo($select); // Create HTML <option> element, set its value with currently iterated key and its text content with currently iterated item and finally append it to the <select>.

					});

				}

				console.log("Tres bien reçu")

			}
		});


	});

});




/*

// Cette fonction permet de récupérer les noms d'équipes
$(function (){

	let _url = "/xapi/int-run-pipline/get-team-names";
	console.log(_url);
	let idCluster = $('#idNiolon').val();


	$.ajax({
			url: _url,
			method:'POST',
			global: true,
			async: true,
			data:{"idCluster":idCluster},
			success: function(data) {

				if(data != null){

				console.log("Tres bien reçu les noms des équipes")
				console.log(data)

				$("#teamListenames").html("");

				$.each(data, function(i) {
    				$("#teamListenames").append("<label>   <input type='checkbox' class='radio' value=" + data[i] + " name='team'/> <b>"  + data[i] +
												 " <b> </label>");
  				});

				$("input:checkbox").on('click', function() {
					// in the handler, 'this' refers to the box clicked on
					let $box = $(this);
					if ($box.is(":checked")) {
						// the name of the box is retrieved using the .attr() method
						// as it is assumed and expected to be immutable
						let group = "input:checkbox[name='" + $box.attr("name") + "']";
						// the checked state of the group/box on the other hand will change
						// and the current value is retrieved using .prop() method
						$(group).prop("checked", false);
						$box.prop("checked", true);
					} else {
						$box.prop("checked", false);
					}
					console.log($(this).attr("value"));
					// On récupère la valeur du nom d'équipe selectionné par l'usr
					nameSelectedTeam = $(this).attr("value");
					console.log("votre repértoire sera /hpc/" + nameSelectedTeam)
					$('#nameExportDir').val("/hpc/" +nameSelectedTeam);



				});


			}


		}
	});

});

*/

// La fonction qui récupère la liste des groupes dont il fait partie l'utilisateur

function getTeams(){

	let _url = "/xapi/int-run-pipline/get-team-names";
	console.log(_url);
	let idCluster = $('#idNiolon').val();


	$.ajax({
			url: _url,
			method:'POST',
			global: true,
			async: true,
			data:{"idCluster":idCluster},
			success: function(data) {

				if(data.data != "null"){

				console.log("Tres bien reçu les noms des équipes")
				console.log(data)

				$("#teamListenames").html("");

				$.each(data, function(i) {
    				$("#teamListenames").append("<label>   <input type='checkbox' class='radio' value=" + data[i] + " name='team'/> <b>"  + data[i] +
												 " <b> </label>");
  				});

				$("input:checkbox").on('click', function() {
					// in the handler, 'this' refers to the box clicked on
					let $box = $(this);
					if ($box.is(":checked")) {
						// the name of the box is retrieved using the .attr() method
						// as it is assumed and expected to be immutable
						let group = "input:checkbox[name='" + $box.attr("name") + "']";
						// the checked state of the group/box on the other hand will change
						// and the current value is retrieved using .prop() method
						$(group).prop("checked", false);
						$box.prop("checked", true);
					} else {
						$box.prop("checked", false);
					}
					console.log($(this).attr("value"));
					// On récupère la valeur du nom d'équipe selectionné par l'usr
					nameSelectedTeam = $(this).attr("value");
					console.log("votre repértoire sera /hpc/" + nameSelectedTeam)
					$('#nameExportDir').val("/hpc/" +nameSelectedTeam);



				});


			}


		}
	});

}








// Récupérer les  informations liées à la BIDSApss choisie

function getInfAboutPipelineSelected(pipeline) {

	let _url = "/xapi/int-run-pipline/get-infos-pipeline";


	$.ajax({
		url: _url,
		method:'POST',
		data: {"pipelineSelected":pipeline},

		success: function(data) {

			if(data != null){
				console.log("link de ce pipeline est : " + data)

				$('#link-pipeline').html('  For more information about   <span style="color:blue">'  +    pipeline
					+ '  </span> click  <a href="' + data.linkDoc + '" target="_blank">  <span style="color:blue"> here </span> </a></h3>');

				$('#commande_befor').val(data.commande_befor);
				$('#command_extra_bids').val(data.command_extra_bids);
				$('#commande_after').val(data.commande_after);
				$('#commande_participant').val(data.commande_participant);

				$('#div-info-msg').show();



			}

			else {
			console.log("vous avez pas recu de linkDoc")
			}


		}
	});


}



/* Cette fonction permet d'envoyer les paramètres choisies par l'utilisateur pour générer un le fichiers batsh*/
$(function() {



	$('#btnStartPipline').on("click" , function(e) {


		$('#pipelineSelected').html(" <h3> Pipeline selected :  <span style=\"color:blue\">"  +    $('#monselectPipeLine option:selected').text() + " </span></h3>");

		let projectSelect = "$project";

		let subjectsSelect = $('option:selected', $('#subjects_list')).map(function(){ return this.text }).get().join(", ");

		let sessionsSelected = $('option:selected', $('#subsession_list')).map(function(){ return this.text }).get().join(", ");
		if(sessionsSelected.length ==0){
			sessionsSelected = "All";
		}

		$('#nameProject').html(" <h3> project  :  <span style=\"color:blue\">"  +  projectSelect + " </span></h3>");

		//$('#nameProject').html(" <h3> subject(s)  :  <span style=\"color:blue\">"  +  subjectsSelect + " </span></h3>");

		$('#sessionsSelected').html(" <h3> session(s)  :  <span style=\"color:blue\">"  +  sessionsSelected + " </span></h3>");

		$('#nameTeamSelected').html(" <h3> team  :  <span style=\"color:blue\">"  +  $("input:checkbox").attr("value") + " </span></h3>");


		openModal();

		/* pour récupérer le contenu du tag <p>    dans  le modal */
		console.log(document.getElementById('nameTeamSelected').textContent);

	})

	$('#bntContinue').on("click" , function(e) {

		closeModal()

		//get url
		let _urlStarttPiplines = document.getElementById("btnStartPipline").getAttribute("data");

		//alert(_urlStarttPiplines);

		let _sessions_ids = $('#subsession_list').val().toString();

		let selectPipeline =  $('#monselectPipeLine option:selected').text();

		let idCluster = $('#idNiolon').val();

		//let subject_ids = $('#subject_ids').val();
		let subject_ids = $('#subjects_list').val();
		let nameExportDir = $('#nameExportDir').val();
		let additionalParams = $('#additionalParams').val();
		let commande_befor = $('#commande_befor').val();
		let commande_after = $('#commande_after').val();
		let commande_participant = $('#commande_participant').val();
		let command_extra_bids = $('#command_extra_bids').val();

		subject_ids = subject_ids.toString();

			if (subject_ids == "" && $('#all_subjects').attr("checked", "checked")){

				subject_ids = "all";
			}

		let radioValue = $("input[name='choice-radio']:checked").val(); // si (yes/no) pour supprimer les données après la conversion

		$.ajax({
			url: _urlStarttPiplines,
			data: {"idCluster":idCluster, "selectPipeline":selectPipeline, "subject_ids":subject_ids,"nameExportDir":nameExportDir, "additionalParams":additionalParams,
				"sessions_ids":_sessions_ids, "radioValue":radioValue, "commande_befor":commande_befor, "commande_after":commande_after, "commande_participant" : commande_participant, "command_extra_bids" : command_extra_bids},
			method:'POST',
			success: function(data) {

				if(data != null){

					console.log("Aucune data reçu mais l'envoi est bon !! " )

				}
				console.log("pipeline choisi est : " +selectPipeline )

				console.log("Tres bien envoyer")


				//idOfJob.innerHTML = " <h3> L'id de votre job est : </h3> "
				//$('#idOfJob').html("<h3> L'id de votre job est : </h3>")

				console.log(data.idJob)
				console.log(data.workindDirectory)

				namfileTogenerateByBrowser = data.pathWithnNameScriptSbatch;

				$('#idJob').html(" <h3> Success :  <span style=\"color:blue\">"  +  data.idJob + " </span></h3>");

				$('#workindDirectory').html(" <h3> Path to export directory is  :  <span style=\"color:blue\">"  +  data.workindDirectory + "</span></h3>");

				$('#pathWithnNameScriptSbatch').html(" <h3> The full path and name of the generated file is :  <span style=\"color:blue\">"  +  data.pathWithnNameScriptSbatch + " </span></h3>");

				$('#pathErrorLogOut').html(" <h3> The full path of Output log :  <span style=\"color:blue\">"  +  data.pathErrorLogOut + " </span></h3>");

				$('#pathErrorLogErr').html(" <h3> The full path of Error log :  <span style=\"color:blue\">"  +  data.pathErrorLogErr + " </span></h3>");


				openLoader()

				setTimeout(function(){
					openModalContinue()
				}, 3000);


				$("#div_step3").hide();
				$('#div-info-msg').hide();
				// Supprimer toutes les options si déja la liste était initialisée
				$('#monselectPipeLine')
					.empty()
					.append('<option selected="selected" value="">Please choose a pipeline</option>');


				$("#div-id-user").show();
				$('#additionalParams').val("");
			}

		});
	})


});


//  Savegarder les information dans un fichier .txt
$('#btnSave').on("click" , function(e) {

		/* pour récupérer le contenu du tag <p>    dans  le modal */
	let text = document.getElementById('idJob').textContent
		    + "\n" + document.getElementById('workindDirectory').textContent
			+ "\n" + document.getElementById('pathWithnNameScriptSbatch').textContent
			+ "\n" + document.getElementById('pathErrorLogOut').textContent
			+ "\n" + document.getElementById('pathErrorLogErr').textContent;

	let nomfile = document.getElementById('workindDirectory').textContent + '.txt';
		nomfile = nomfile.substring(nomfile.lastIndexOf("/") +1);

  if ('Blob' in window) {
    var fileName = prompt('Please enter file name to save', nomfile);
    if (fileName) {
      var textFileAsBlob = new Blob([text], { type: 'text/plain' });

      if ('msSaveOrOpenBlob' in navigator) {
        navigator.msSaveOrOpenBlob(textFileAsBlob, fileName);
      } else {
        var downloadLink = document.createElement('a');
        downloadLink.download = fileName;
        downloadLink.innerHTML = 'Download File';

        if ('webkitURL' in window) {
          // Chrome allows the link to be clicked without actually adding it to the DOM.
          downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
        } else {
          // Firefox requires the link to be added to the DOM before it can be clicked.
          downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
          downloadLink.click(function(){
            document.body.removeChild(event.target);
          });

          downloadLink.style.display = 'none';
          document.body.appendChild(downloadLink);
        }
        downloadLink.click();
      }
    }
	closeModalContinue();
  } else {
    alert('Your browser does not support the HTML5 Blob.');
  }
});


// si le choix est  'ok' on fait rien
document.getElementById("btnOkFinale").addEventListener("click", function(){


	closeModalContinue();

}, false);






function download(filename, text) {
    var element = document.createElement('a');
    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
    element.setAttribute('download', filename);

    element.style.display = 'none';
    document.body.appendChild(element);

    element.click();

    document.body.removeChild(element);
}





// Get DOM Elements
const modal = document.querySelector('#my-modal');

const modalContinue = document.querySelector('#my-modal-continue');

const loader = document.querySelector('#loader');



//const modalBtn = document.querySelector('#modal-btn');
const closeBtn = document.querySelector('.close');



// Events
//modalBtn.addEventListener('click', openModal);
closeBtn.addEventListener('click', closeModalContinue);
window.addEventListener('click', outsideClick);


bntModify.addEventListener('click', closeModal)

// Open
function openModal() {

  modal.style.display = 'block';
}


// Close
function closeModal() {
  modal.style.display = 'none';
}



// Close If Outside Click
function outsideClick(e) {
  if (e.target == modal) {
    modal.style.display = 'none';
  }
}



// Open
function openLoader() {


  loader.style.display = 'block';


}



window.addEventListener('click', outsideClickContinue);

bntModify.addEventListener('click', closeModalContinue)

// Open
function openModalContinue() {

  loader.style.display = 'none';
  modalContinue.style.display = 'block';
}



// Close
function closeModalContinue() {
  modalContinue.style.display = 'none';

}

// Close If Outside Click
function outsideClickContinue(e) {
  if (e.target == modalContinue) {
    modalContinue.style.display = 'none';
  }
}







$(function () {


	var __form = $('#export-project-data-form');
	var __subjectSelect = $('#subjects_list', __form);

	$('input[name="subject_choice"]', __form).on("change", function () {
		var __subjectChoice = $('input[name="subject_choice"]:checked', __form);
		var __enableSubjectSelect = true;
		if (__subjectChoice.val () !== 'some') {
			__enableSubjectSelect = false;
		}

		var __subjectSelectDisabled = __subjectSelect.prop('disabled');
		if (__enableSubjectSelect) {
			if (__subjectSelectDisabled) {
				__subjectSelect.prop('disabled', false);
			}
		}
		else {
			if (!__subjectSelectDisabled) {
				__subjectSelect.prop('disabled', true);
			}
		}
	});


	var __subjectListRequest = serverRoot + "/REST/projects/$project/subjects?XNAT_CSRF=" + csrfToken;

	$.ajax({
		url : __subjectListRequest,
		type: 'get',
		global: true,
		async: true,
		success : function (data) {
			console.log("********************");
			//console.log (data);
			__subjectSelect.val("");
			__subjectSelect.html("");
			var selectOptions = "";
			for (var iLevel in data) {
				if (iLevel === "ResultSet") {
					for (var jLevel in data[iLevel]) {
						if (jLevel == "Result") {
							$.each (data[iLevel][jLevel], function (key, value) {
								//console.log (key + " : " + value);
								selectOptions += '<option value="' + value["ID"] + '">' + value["label"] + '</option>';
							});
							break;
						}
					}
				}
			}

			$(function() {
			// choose target dropdown
			var select = $('#subjects_list');
			select.html(select.find('option').sort(function(x, y) {
				// to change to descending order switch "<" for ">"
				return $(x).text() > $(y).text() ? 1 : -1;
			}));

			});
			console.log (selectOptions);
			if (selectOptions !== "") {
				__subjectSelect.html (selectOptions);
			}
			//xmodal.message ("DEBUG", selectOptions);
		}
	});
});


function processExportProjectForm () {

		var __form = $('#export-project-data-form');

		var __subjectChoice = $('input[name="subject_choice"]:checked', __form);
		var __subjectSelect = $('#subjects_list', __form);
		var __imageFormatChoice = $('input[name="image_format_choice"]:checked', __form);
		var __diskTreeFormatChoice = $('input[name="disk_tree_format_choice"]:checked', __form);
		var __subjectIds = $('#subject_ids', __form);

		if ((__imageFormatChoice.val () == 'dicom') && (__diskTreeFormatChoice.val () == 'bids')) {
			xmodal.message ("Error", "The BIDS structure does not apply to DICOM images.");
			return false;
		}

		if (__subjectChoice.val() == 'some') {
			var __arrayIds = [];
			__arrayIds.push (__subjectSelect.val());

			//$('#subject_ids', __form).val (JSON.stringify (__arrayIds));
			$('#subject_ids', __form).val (__arrayIds);
		}
		else {
			$('#subject_ids', __form).val ("all");
		}

		console.log ($('#subject_ids', __form).val());

		//__form.attr ('action', __xapiRequest);

		return true;
}




</script>

<script type="text/javascript"> document.addEventListener('click', function(e) { if(document.activeElement.toString() == '[object HTMLButtonElement]'){ document.activeElement.blur(); } }); </script>
